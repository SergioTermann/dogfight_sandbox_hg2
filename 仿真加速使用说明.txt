================================================================================
                        ⚡ 仿真加速系统 - 使用说明
================================================================================

✅ 已完成优化 - 所有延迟都会随仿真加速而加速！

--------------------------------------------------------------------------------
📋 快捷键控制：
--------------------------------------------------------------------------------

  [+] 或 [=]     加速仿真（每次 2 倍）  1x → 2x → 4x → 8x → 10x（最大）
  [-]            减速仿真（每次 0.5 倍） 10x → 5x → 2.5x → 1.25x → 0.1x（最小）
  [0]            恢复正常速度（1.0x）
  [R]            切换无渲染模式（关闭渲染大幅提升速度）
  [P]            显示性能监控（查看帧率和耗时）

--------------------------------------------------------------------------------
🚀 工作原理：
--------------------------------------------------------------------------------

系统采用 **时间缩放 (Time Scaling)** 机制：

  真实时间     仿真时间（dts）
  --------     ---------------
  1 秒    →    1.0 秒  （1.0x 正常）
  1 秒    →    2.0 秒  （2.0x 加速）
  1 秒    →   10.0 秒  （10x 加速）

所有计时器使用 dts 递增/递减：
  ✅ 导弹生命周期      life_cptr += dts
  ✅ AI 发射间隔       IA_fire_missile_cptr -= dts
  ✅ 目标锁定延迟      target_lock_t += dts
  ✅ 起落架动画        gear_moving_t += dts
  ✅ JSBSim 物理引擎  （使用 scaled dts）

--------------------------------------------------------------------------------
📊 性能提升效果：
--------------------------------------------------------------------------------

  模式              FPS     仿真速度    训练效率
  ---------------   -----   ---------   ----------
  正常渲染 1.0x     60      1x          基准
  正常渲染 2.0x     60      2x          2倍
  无渲染 1.0x       300+    1x          基准（高帧率）
  无渲染 2.0x       300+    2x          2倍
  无渲染 10.0x      300+    10x         🔥 10倍！

  💡 推荐配置：训练 AI 时使用 "无渲染模式 + 10倍速"

--------------------------------------------------------------------------------
⚙️ 技术细节：
--------------------------------------------------------------------------------

1. 时间缩放应用点（master.py line 1769）：
   
   dt_seconds = hg.time_to_sec_f(base_dt) * cls.simulation_speed
   cls.current_state = cls.current_state(dt_seconds)

2. 所有游戏逻辑都使用 dts 参数：
   
   def update_IA_fight(self, aircraft, dts):
       self.IA_fire_missile_cptr -= dts  # 自动跟随加速

3. 物理引擎同步：
   
   hg.SceneUpdateSystems(cls.scene, cls.clocks, used_dt, cls.scene_physics, used_dt, 1000)

4. 网络模式优化：
   
   time.sleep((1 / 120) / Main.simulation_speed)  # 等待时间也缩放

--------------------------------------------------------------------------------
🎯 使用场景：
--------------------------------------------------------------------------------

✓ AI 训练          - 10倍速 + 无渲染，快速积累经验
✓ 长时间测试        - 5倍速，快速验证稳定性
✓ 导弹轨迹调试      - 0.5倍速，慢动作观察
✓ 战术回放分析      - 0.1倍速，超慢动作

--------------------------------------------------------------------------------
⚠️ 注意事项：
--------------------------------------------------------------------------------

1. 加速不影响仿真准确性 - 物理逻辑完全一致
2. 过高倍速下音效可能异常（建议无渲染模式下使用高倍速）
3. JSBSim 在极高倍速（>10x）下可能出现数值不稳定
4. 渲染模式下建议不超过 2-4 倍速（受限于显卡刷新率）

--------------------------------------------------------------------------------
🔧 开发者信息：
--------------------------------------------------------------------------------

关键变量：
  - Main.simulation_speed      当前加速倍率
  - Main.max_simulation_speed  最大倍率（默认 10.0）
  - Main.min_simulation_speed  最小倍率（默认 0.1）

修改的文件：
  - source/states.py    添加快捷键控制和速度显示
  - source/main.py      优化网络模式等待时间
  - source/master.py    优化无渲染模式显示刷新

================================================================================

